ft-build:
  box:
    id: node
  steps:
    - script:
      name: env check
      code: env
    - npm-install:
      cwd: ./front
    - script:
      cwd: ./front
      name: lint
      code: npm run lint

bk-build:
  box:
    id: michilu/docker-goapp
  steps:
    - script:
      name: env check
      code: env
    - script:
      name: lint
      code: make lint
    - script:
      name: test
      code: goapp test -v ./...
    - script:
      name: front bindata
      code: make bindata
    - script:
      name: build
      code: goapp build ./server

deploy:
  box:
    id: michilu/docker-goapp
  steps:
    - script:
        name: deploy info
        code: find .
    - michilu/go-appengine-deploy:
      token: $APP_ENGINE_TOKEN
